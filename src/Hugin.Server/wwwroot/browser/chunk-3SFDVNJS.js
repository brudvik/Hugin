import{b as L,d as K,f as N,q as R}from"./chunk-VCIVRVDU.js";import{a as j}from"./chunk-CG4X7TY4.js";import{$a as g,Ga as k,La as u,Oa as w,Qa as T,Rb as W,Sa as f,Ua as y,Ub as B,V as F,Va as S,Wa as O,Xa as t,Ya as n,Z as M,Za as _,_a as h,ab as d,eb as r,fb as x,ga as p,gb as E,ha as c,jb as C,kb as b,lb as v,nb as V,ob as P,qb as I,za as l}from"./chunk-UR2BHKY7.js";var A=(o,m)=>m.name,D=()=>[],U=(o,m)=>({"bg-success":o,"bg-secondary":m});function z(o,m){o&1&&(t(0,"div",10)(1,"div",21)(2,"span",22),r(3,"Laster..."),n()()())}function H(o,m){if(o&1){let e=h();t(0,"div",10),_(1,"i",23),t(2,"p",24),r(3,"Ingen operat\xF8rer konfigurert"),n(),t(4,"button",6),g("click",function(){p(e);let i=d();return c(i.showAddModal())}),_(5,"i",7),r(6,"Legg til f\xF8rste operat\xF8r "),n()()}}function $(o,m){if(o&1&&(t(0,"small",20),r(1),n()),o&2){let e=d().$implicit;l(),x(e.email)}}function G(o,m){if(o&1&&(t(0,"code"),r(1),n()),o&2){let e=d().$implicit;l(),x(e.hostmask)}}function q(o,m){o&1&&(t(0,"span",20),r(1,"Alle"),n())}function J(o,m){if(o&1&&(t(0,"span",31),r(1),n()),o&2){let e=m.$implicit;l(),x(e)}}function Q(o,m){o&1&&(t(0,"span",20),r(1,"Standard"),n())}function X(o,m){if(o&1){let e=h();t(0,"tr")(1,"td")(2,"div",27)(3,"div",28),_(4,"i",29),n(),t(5,"div")(6,"div",30),r(7),n(),u(8,$,2,1,"small",20),n()()(),t(9,"td")(10,"code"),r(11),n()(),t(12,"td"),u(13,G,2,1,"code")(14,q,2,0,"span",20),n(),t(15,"td"),S(16,J,2,1,"span",31,y),u(18,Q,2,0,"span",20),n(),t(19,"td")(20,"span",32),r(21),n()(),t(22,"td",26)(23,"div",33)(24,"button",34),g("click",function(){let i=p(e).$implicit,s=d(2);return c(s.editOperator(i))}),_(25,"i",35),n(),t(26,"button",36),g("click",function(){let i=p(e).$implicit,s=d(2);return c(s.resetPassword(i))}),_(27,"i",37),n(),t(28,"button",38),g("click",function(){let i=p(e).$implicit,s=d(2);return c(s.deleteOperator(i))}),_(29,"i",39),n()()()()}if(o&2){let e=m.$implicit;l(7),x(e.name),l(),f(e.email?8:-1),l(3),x(e.username),l(2),f(e.hostmask?13:14),l(3),O(e.flags||P(7,D)),l(2),f(e.flags!=null&&e.flags.length?-1:18),l(2),w("ngClass",I(8,U,e.isOnline,!e.isOnline)),l(),E(" ",e.isOnline?"Online":"Offline"," ")}}function Y(o,m){if(o&1&&(t(0,"div",11)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),r(5,"Navn"),n(),t(6,"th"),r(7,"Brukernavn"),n(),t(8,"th"),r(9,"Hostmask"),n(),t(10,"th"),r(11,"Rettigheter"),n(),t(12,"th"),r(13,"Status"),n(),t(14,"th",26),r(15,"Handlinger"),n()()(),t(16,"tbody"),S(17,X,30,11,"tr",null,A),n()()()),o&2){let e=d();l(17),O(e.operators())}}function Z(o,m){if(o&1){let e=h();t(0,"div",47)(1,"label",48),r(2,"Passord"),n(),t(3,"input",60),v("ngModelChange",function(i){p(e);let s=d(2);return b(s.operForm.password,i)||(s.operForm.password=i),c(i)}),n()()}if(o&2){let e=d(2);l(3),C("ngModel",e.operForm.password)}}function ee(o,m){if(o&1){let e=h();t(0,"div",54)(1,"div",61)(2,"input",62),g("change",function(){let i=p(e).$implicit,s=d(2);return c(s.toggleFlag(i))}),n(),t(3,"label",63),r(4),n()()()}if(o&2){let e=m.$implicit,a=d(2);l(2),w("id","flag-"+e)("checked",a.operForm.flags.includes(e)),l(),w("for","flag-"+e),l(),x(e)}}function te(o,m){if(o&1){let e=h();t(0,"div",40),g("click",function(i){p(e);let s=d();return c(s.closeModal(i))}),t(1,"div",41)(2,"div",42)(3,"div",43)(4,"h5",44),r(5),n(),t(6,"button",45),g("click",function(){p(e);let i=d();return c(i.showModal.set(!1))}),n()(),t(7,"div",46)(8,"div",47)(9,"label",48),r(10,"Navn"),n(),t(11,"input",49),v("ngModelChange",function(i){p(e);let s=d();return b(s.operForm.name,i)||(s.operForm.name=i),c(i)}),n()(),t(12,"div",47)(13,"label",48),r(14,"Brukernavn"),n(),t(15,"input",50),v("ngModelChange",function(i){p(e);let s=d();return b(s.operForm.username,i)||(s.operForm.username=i),c(i)}),n()(),u(16,Z,4,1,"div",47),t(17,"div",47)(18,"label",48),r(19,"Hostmask (valgfritt)"),n(),t(20,"input",51),v("ngModelChange",function(i){p(e);let s=d();return b(s.operForm.hostmask,i)||(s.operForm.hostmask=i),c(i)}),n(),t(21,"small",52),r(22,"Begrens OPER-tilgang til spesifikke verter"),n()(),t(23,"div",47)(24,"label",48),r(25,"E-post (valgfritt)"),n(),t(26,"input",53),v("ngModelChange",function(i){p(e);let s=d();return b(s.operForm.email,i)||(s.operForm.email=i),c(i)}),n()(),t(27,"div",47)(28,"label",48),r(29,"Rettigheter"),n(),t(30,"div",17),S(31,ee,5,4,"div",54,y),n()()(),t(33,"div",55)(34,"button",56),g("click",function(){p(e);let i=d();return c(i.showModal.set(!1))}),r(35," Avbryt "),n(),t(36,"button",57),g("click",function(){p(e);let i=d();return c(i.saveOperator())}),_(37,"i",58),r(38,"Lagre "),n()()()()(),_(39,"div",59)}if(o&2){let e=d();l(5),E(" ",e.editingOperator()?"Rediger operat\xF8r":"Ny operat\xF8r"," "),l(6),C("ngModel",e.operForm.name),l(4),C("ngModel",e.operForm.username),l(),f(e.editingOperator()?-1:16),l(4),C("ngModel",e.operForm.hostmask),l(6),C("ngModel",e.operForm.email),l(5),O(e.availableFlags)}}var me=(()=>{class o{apiService=F(j);loading=k(!1);operators=k([]);showModal=k(!1);editingOperator=k(null);availableFlags=["global","local","kill","kline","gline","rehash"];operForm={name:"",username:"",password:"",hostmask:"",email:"",flags:[]};ngOnInit(){this.refresh()}refresh(){this.loading.set(!0),this.apiService.getOperators().subscribe({next:e=>{this.operators.set(e),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}showAddModal(){this.editingOperator.set(null),this.operForm={name:"",username:"",password:"",hostmask:"",email:"",flags:["local"]},this.showModal.set(!0)}editOperator(e){this.editingOperator.set(e),this.operForm={name:e.name,username:e.username,password:"",hostmask:e.hostmask||"",email:e.email||"",flags:[...e.flags||[]]},this.showModal.set(!0)}toggleFlag(e){let a=this.operForm.flags.indexOf(e);a===-1?this.operForm.flags.push(e):this.operForm.flags.splice(a,1)}saveOperator(){if(!this.operForm.name||!this.operForm.username){alert("Navn og brukernavn er p\xE5krevd");return}if(!this.editingOperator()&&!this.operForm.password){alert("Passord er p\xE5krevd for nye operat\xF8rer");return}let e={name:this.operForm.name,username:this.operForm.username,password:this.operForm.password||void 0,hostmask:this.operForm.hostmask||void 0,email:this.operForm.email||void 0,flags:this.operForm.flags};this.editingOperator()?this.apiService.updateOperator(this.editingOperator().name,e).subscribe({next:()=>{this.showModal.set(!1),this.refresh()},error:a=>{alert("Kunne ikke oppdatere operat\xF8r: "+(a.error?.message||"Ukjent feil"))}}):this.apiService.createOperator(e).subscribe({next:()=>{this.showModal.set(!1),this.refresh()},error:a=>{alert("Kunne ikke opprette operat\xF8r: "+(a.error?.message||"Ukjent feil"))}})}resetPassword(e){let a=prompt(`Nytt passord for ${e.name}:`);a&&this.apiService.updateOperator(e.name,{password:a}).subscribe({next:()=>{alert("Passord oppdatert!")},error:i=>{alert("Kunne ikke oppdatere passord: "+(i.error?.message||"Ukjent feil"))}})}deleteOperator(e){confirm(`Er du sikker p\xE5 at du vil slette operat\xF8ren ${e.name}?`)&&this.apiService.deleteOperator(e.name).subscribe({next:()=>{this.refresh()},error:a=>{alert("Kunne ikke slette operat\xF8r: "+(a.error?.message||"Ukjent feil"))}})}closeModal(e){e.target.classList.contains("modal")&&this.showModal.set(!1)}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=M({type:o,selectors:[["app-operators"]],standalone:!0,features:[V],decls:62,vars:5,consts:[[1,"operators-page"],[1,"page-header","mb-4"],[1,"text-muted","mb-0"],[1,"header-actions"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-sync-alt"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],[1,"card"],[1,"card-body","p-0"],[1,"text-center","py-5"],[1,"table-responsive"],[1,"card","mt-4"],[1,"card-header"],[1,"mb-0"],[1,"fas","fa-info-circle","me-2"],[1,"card-body"],[1,"row"],[1,"col-md-4","mb-3"],[1,"badge","bg-primary"],[1,"text-muted"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"fas","fa-user-shield","fa-3x","text-muted","mb-3"],[1,"text-muted","mb-3"],[1,"table","table-hover","mb-0"],[1,"text-end"],[1,"d-flex","align-items-center"],[1,"oper-avatar","me-2"],[1,"fas","fa-user-shield"],[1,"fw-medium"],[1,"badge","bg-primary","me-1"],[1,"badge",3,"ngClass"],[1,"btn-group","btn-group-sm"],["title","Rediger",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-edit"],["title","Tilbakestill passord",1,"btn","btn-outline-warning",3,"click"],[1,"fas","fa-key"],["title","Slett",1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],["tabindex","-1",1,"modal","show","d-block",3,"click"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Operat\xF8rnavn",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Brukernavn for OPER-kommando",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","*@*.example.com",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text","text-muted"],["type","email","placeholder","oper@example.com",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-6"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-save","me-2"],[1,"modal-backdrop","show"],["type","password","placeholder","Passord for OPER-kommando",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"]],template:function(a,i){a&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),r(4,"Operat\xF8rer"),n(),t(5,"p",2),r(6,"Administrer IRC-operat\xF8rer (IRCops)"),n()(),t(7,"div",3)(8,"button",4),g("click",function(){return i.refresh()}),_(9,"i",5),n(),t(10,"button",6),g("click",function(){return i.showAddModal()}),_(11,"i",7),r(12,"Ny operat\xF8r "),n()()(),t(13,"div",8)(14,"div",9),u(15,z,4,0,"div",10)(16,H,7,0,"div",10)(17,Y,19,0,"div",11),n()(),t(18,"div",12)(19,"div",13)(20,"h5",14),_(21,"i",15),r(22," Operat\xF8r-rettigheter "),n()(),t(23,"div",16)(24,"div",17)(25,"div",18)(26,"h6")(27,"span",19),r(28,"global"),n()(),t(29,"small",20),r(30,"Full tilgang til alle serverkommandoer"),n()(),t(31,"div",18)(32,"h6")(33,"span",19),r(34,"local"),n()(),t(35,"small",20),r(36,"Tilgang til lokale kommandoer"),n()(),t(37,"div",18)(38,"h6")(39,"span",19),r(40,"kill"),n()(),t(41,"small",20),r(42,"Kan koble fra brukere med KILL"),n()(),t(43,"div",18)(44,"h6")(45,"span",19),r(46,"kline"),n()(),t(47,"small",20),r(48,"Kan legge til K-lines (utestengelser)"),n()(),t(49,"div",18)(50,"h6")(51,"span",19),r(52,"gline"),n()(),t(53,"small",20),r(54,"Kan legge til G-lines (globale utestengelser)"),n()(),t(55,"div",18)(56,"h6")(57,"span",19),r(58,"rehash"),n()(),t(59,"small",20),r(60,"Kan laste inn konfigurasjon p\xE5 nytt"),n()()()()()(),u(61,te,40,6)),a&2&&(l(8),w("disabled",i.loading()),l(),T("fa-spin",i.loading()),l(6),f(i.loading()?15:i.operators().length===0?16:17),l(46),f(i.showModal()?61:-1))},dependencies:[B,W,R,L,K,N],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:1rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;margin-bottom:.25rem}.oper-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,#f59e0b,#d97706);display:flex;align-items:center;justify-content:center;color:#fff;font-size:.875rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.8rem;text-transform:uppercase;letter-spacing:.05em;color:var(--bs-gray-400);border-bottom-width:1px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}code[_ngcontent-%COMP%]{background:#0000004d;padding:.125rem .375rem;border-radius:.25rem}.modal[_ngcontent-%COMP%]{background:#00000080}.modal-content[_ngcontent-%COMP%]{background:var(--card-bg);border-color:var(--card-border)}.modal-header[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{border-color:var(--bs-border-color)}"]})}return o})();export{me as OperatorsComponent};
