import{a as K,b as D,d as z,f as N,h as Q,k as H,l as R,m as U,n as Y,o as q,q as G}from"./chunk-VCIVRVDU.js";import{a as J}from"./chunk-CG4X7TY4.js";import{$a as p,Ga as x,La as k,Oa as V,Qa as E,Sa as v,Tb as j,Ua as F,Ub as A,V as O,Va as P,Wa as T,Xa as n,Ya as i,Z as I,Za as _,_a as S,ab as d,eb as o,fb as y,ga as c,gb as w,ha as m,jb as C,kb as g,lb as f,nb as W,sb as L,tb as B,za as s}from"./chunk-UR2BHKY7.js";var X=(l,u)=>u.name;function Z(l,u){l&1&&(n(0,"div",25)(1,"div",27)(2,"span",28),o(3,"Laster..."),i()()())}function $(l,u){l&1&&(n(0,"div",26)(1,"div",29),_(2,"i",30),n(3,"p",31),o(4,"Ingen kanaler funnet"),i()()())}function ee(l,u){l&1&&(n(0,"span",40),_(1,"i",56),i())}function te(l,u){l&1&&(n(0,"span",41),_(1,"i",57),i())}function ne(l,u){l&1&&(n(0,"span",42),_(1,"i",58),i())}function ie(l,u){if(l&1){let e=S();n(0,"div",33)(1,"div",35)(2,"div",36)(3,"h5",37),_(4,"i",38),o(5),i(),n(6,"div",39),k(7,ee,2,0,"span",40)(8,te,2,0,"span",41)(9,ne,2,0,"span",42),i()(),n(10,"div",9)(11,"p",43),o(12),i(),n(13,"div",44)(14,"div",45),_(15,"i",46),n(16,"span"),o(17),i()(),n(18,"div",45),_(19,"i",47),n(20,"span"),o(21),i()()()(),n(22,"div",48)(23,"div",49)(24,"button",50),p("click",function(){let t=c(e).$implicit,a=d(2);return m(a.showChannelDetails(t))}),_(25,"i",51),o(26,"Detaljer "),i(),n(27,"button",52),p("click",function(){let t=c(e).$implicit,a=d(2);return m(a.editChannel(t))}),_(28,"i",53),o(29,"Rediger "),i(),n(30,"button",54),p("click",function(){let t=c(e).$implicit,a=d(2);return m(a.deleteChannel(t))}),_(31,"i",55),o(32,"Slett "),i()()()()()}if(l&2){let e=u.$implicit;s(5),w(" ",e.name," "),s(2),v(e.isPrivate?7:-1),s(),v(e.isSecret?8:-1),s(),v(e.isModerated?9:-1),s(3),w(" ",e.topic||"Ingen tema satt"," "),s(5),w("",e.userCount," brukere"),s(4),w("",e.messageCount||0," meldinger")}}function ae(l,u){if(l&1){let e=S();n(0,"li",60)(1,"button",61),p("click",function(){let t=c(e).$implicit,a=d(3);return m(a.goToPage(t))}),o(2),i()()}if(l&2){let e=u.$implicit,r=d(3);E("active",e===r.currentPage()),s(2),y(e)}}function oe(l,u){if(l&1){let e=S();n(0,"div",34)(1,"nav")(2,"ul",59)(3,"li",60)(4,"button",61),p("click",function(){c(e);let t=d(2);return m(t.goToPage(t.currentPage()-1))}),_(5,"i",62),i()(),P(6,ae,3,3,"li",63,F),n(8,"li",60)(9,"button",61),p("click",function(){c(e);let t=d(2);return m(t.goToPage(t.currentPage()+1))}),_(10,"i",64),i()()()()()}if(l&2){let e=d(2);s(3),E("disabled",e.currentPage()===1),s(3),T(e.visiblePages()),s(2),E("disabled",e.currentPage()===e.totalPages())}}function le(l,u){if(l&1&&(n(0,"div",32),P(1,ie,33,7,"div",33,X),i(),k(3,oe,11,4,"div",34)),l&2){let e=d();s(),T(e.channels()),s(2),v(e.totalPages()>1?3:-1)}}function re(l,u){if(l&1&&(n(0,"span",83),o(1),i()),l&2){let e=u.$implicit;s(),y(e)}}function se(l,u){if(l&1&&P(0,re,2,1,"span",83,F),l&2){let e,r=d(2);T((e=r.selectedChannel())==null?null:e.users)}}function de(l,u){l&1&&(n(0,"span",31),o(1,"Ingen brukere"),i())}function ce(l,u){if(l&1){let e=S();n(0,"div",65),p("click",function(t){c(e);let a=d();return m(a.closeModal(t))}),n(1,"div",66)(2,"div",67)(3,"div",68)(4,"h5",69),_(5,"i",70),o(6),i(),n(7,"button",71),p("click",function(){c(e);let t=d();return m(t.selectedChannel.set(null))}),i()(),n(8,"div",72)(9,"div",73)(10,"div",74)(11,"h6",75),o(12,"Kanalinformasjon"),i(),n(13,"dl",76)(14,"dt",77),o(15,"Tema"),i(),n(16,"dd",78),o(17),i(),n(18,"dt",77),o(19,"Opprettet"),i(),n(20,"dd",78),o(21),L(22,"date"),i(),n(23,"dt",77),o(24,"Brukere"),i(),n(25,"dd",78),o(26),i(),n(27,"dt",77),o(28,"Moduser"),i(),n(29,"dd",78)(30,"code"),o(31),i()()()(),n(32,"div",74)(33,"h6",75),o(34,"Brukerliste"),i(),n(35,"div",79),k(36,se,2,0)(37,de,2,0,"span",31),i()()()(),n(38,"div",80)(39,"button",81),p("click",function(){c(e);let t=d();return m(t.selectedChannel.set(null))}),o(40," Lukk "),i()()()()(),_(41,"div",82)}if(l&2){let e,r,t,a,h,b,M=d();s(6),w(" ",(e=M.selectedChannel())==null?null:e.name," "),s(11),y(((r=M.selectedChannel())==null?null:r.topic)||"-"),s(4),y(B(22,6,(t=M.selectedChannel())==null?null:t.createdAt,"medium")),s(5),y((a=M.selectedChannel())==null?null:a.userCount),s(5),y(((h=M.selectedChannel())==null?null:h.modes)||"+"),s(5),v(!((b=M.selectedChannel())==null||b.users==null)&&b.users.length?36:37)}}function me(l,u){if(l&1){let e=S();n(0,"div",65),p("click",function(t){c(e);let a=d();return m(a.closeEditModal(t))}),n(1,"div",84)(2,"div",67)(3,"div",68)(4,"h5",69),o(5),i(),n(6,"button",71),p("click",function(){c(e);let t=d();return m(t.showEditModal.set(!1))}),i()(),n(7,"div",72)(8,"div",85)(9,"label",86),o(10,"Kanalnavn"),i(),n(11,"div",12)(12,"span",13),o(13,"#"),i(),n(14,"input",87),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.name,t)||(a.editForm.name=t),m(t)}),i()()(),n(15,"div",85)(16,"label",86),o(17,"Tema"),i(),n(18,"input",88),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.topic,t)||(a.editForm.topic=t),m(t)}),i()(),n(19,"div",89)(20,"div",90)(21,"div",91)(22,"input",92),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.isPrivate,t)||(a.editForm.isPrivate=t),m(t)}),i(),n(23,"label",93),o(24,"Privat (+p)"),i()()(),n(25,"div",90)(26,"div",91)(27,"input",94),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.isSecret,t)||(a.editForm.isSecret=t),m(t)}),i(),n(28,"label",95),o(29,"Hemmelig (+s)"),i()()(),n(30,"div",90)(31,"div",91)(32,"input",96),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.isModerated,t)||(a.editForm.isModerated=t),m(t)}),i(),n(33,"label",97),o(34,"Moderert (+m)"),i()()(),n(35,"div",90)(36,"div",91)(37,"input",98),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.isInviteOnly,t)||(a.editForm.isInviteOnly=t),m(t)}),i(),n(38,"label",99),o(39,"Kun invitasjon (+i)"),i()()()(),n(40,"div",85)(41,"label",86),o(42,"Brukergrense (0 = ingen grense)"),i(),n(43,"input",100),f("ngModelChange",function(t){c(e);let a=d();return g(a.editForm.userLimit,t)||(a.editForm.userLimit=t),m(t)}),i()()(),n(44,"div",80)(45,"button",81),p("click",function(){c(e);let t=d();return m(t.showEditModal.set(!1))}),o(46," Avbryt "),i(),n(47,"button",101),p("click",function(){c(e);let t=d();return m(t.saveChannel())}),_(48,"i",102),o(49,"Lagre "),i()()()()(),_(50,"div",82)}if(l&2){let e=d();s(5),w(" ",e.editingChannel()?"Rediger kanal":"Opprett kanal"," "),s(9),C("ngModel",e.editForm.name),V("disabled",!!e.editingChannel()),s(4),C("ngModel",e.editForm.topic),s(4),C("ngModel",e.editForm.isPrivate),s(5),C("ngModel",e.editForm.isSecret),s(5),C("ngModel",e.editForm.isModerated),s(5),C("ngModel",e.editForm.isInviteOnly),s(6),C("ngModel",e.editForm.userLimit)}}var ve=(()=>{class l{apiService=O(J);loading=x(!1);channels=x([]);selectedChannel=x(null);showEditModal=x(!1);editingChannel=x(null);searchQuery="";filterType="";currentPage=x(1);pageSize=12;totalItems=x(0);totalPages=x(0);editForm={name:"",topic:"",isPrivate:!1,isSecret:!1,isModerated:!1,isInviteOnly:!1,userLimit:0};Math=Math;ngOnInit(){this.refresh()}refresh(){this.loading.set(!0),this.apiService.getChannels(this.currentPage(),this.pageSize,this.searchQuery||void 0).subscribe({next:e=>{this.channels.set(e.items),this.totalItems.set(e.totalCount),this.totalPages.set(e.totalPages),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}search(){this.currentPage.set(1),this.refresh()}goToPage(e){e<1||e>this.totalPages()||(this.currentPage.set(e),this.refresh())}visiblePages(){let e=this.totalPages(),r=this.currentPage(),t=[],a=Math.max(1,r-2),h=Math.min(e,r+2);h-a<4&&(a===1?h=Math.min(e,5):a=Math.max(1,e-4));for(let b=a;b<=h;b++)t.push(b);return t}showChannelDetails(e){this.selectedChannel.set(e)}showCreateModal(){this.editingChannel.set(null),this.editForm={name:"",topic:"",isPrivate:!1,isSecret:!1,isModerated:!1,isInviteOnly:!1,userLimit:0},this.showEditModal.set(!0)}editChannel(e){this.editingChannel.set(e),this.editForm={name:e.name,topic:e.topic||"",isPrivate:e.isPrivate||!1,isSecret:e.isSecret||!1,isModerated:e.isModerated||!1,isInviteOnly:e.isInviteOnly||!1,userLimit:e.userLimit||0},this.showEditModal.set(!0)}saveChannel(){if(!this.editForm.name){alert("Kanalnavn er p\xE5krevd");return}let e={name:this.editForm.name.startsWith("#")?this.editForm.name:"#"+this.editForm.name,topic:this.editForm.topic,isPrivate:this.editForm.isPrivate,isSecret:this.editForm.isSecret,isModerated:this.editForm.isModerated,isInviteOnly:this.editForm.isInviteOnly,userLimit:this.editForm.userLimit};this.editingChannel()?this.apiService.updateChannel(e.name,e).subscribe({next:()=>{this.showEditModal.set(!1),this.refresh()},error:r=>{alert("Kunne ikke oppdatere kanal: "+(r.error?.message||"Ukjent feil"))}}):this.apiService.createChannel(e).subscribe({next:()=>{this.showEditModal.set(!1),this.refresh()},error:r=>{alert("Kunne ikke opprette kanal: "+(r.error?.message||"Ukjent feil"))}})}deleteChannel(e){confirm(`Er du sikker p\xE5 at du vil slette kanalen ${e.name}?`)&&this.apiService.deleteChannel(e.name).subscribe({next:()=>{this.refresh()},error:r=>{alert("Kunne ikke slette kanal: "+(r.error?.message||"Ukjent feil"))}})}closeModal(e){e.target.classList.contains("modal")&&this.selectedChannel.set(null)}closeEditModal(e){e.target.classList.contains("modal")&&this.showEditModal.set(!1)}static \u0275fac=function(r){return new(r||l)};static \u0275cmp=I({type:l,selectors:[["app-channels"]],standalone:!0,features:[W],decls:40,vars:8,consts:[[1,"channels-page"],[1,"page-header","mb-4"],[1,"text-muted","mb-0"],[1,"header-actions"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-sync-alt"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text","placeholder","S\xF8k etter kanal...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"col-md-3"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["value","public"],["value","private"],["value","secret"],[1,"col-md-2"],[1,"btn","btn-primary","w-100",3,"click"],[1,"fas","fa-search","me-2"],[1,"text-center","py-5"],[1,"card"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"card-body","text-center","py-5"],[1,"fas","fa-hashtag","fa-3x","text-muted","mb-3"],[1,"text-muted"],[1,"row","g-4"],[1,"col-md-6","col-lg-4"],[1,"d-flex","justify-content-center","mt-4"],[1,"card","channel-card","h-100"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"fas","fa-hashtag","text-muted","me-1"],[1,"channel-badges"],["title","Privat",1,"badge","bg-warning"],["title","Hemmelig",1,"badge","bg-danger"],["title","Moderert",1,"badge","bg-info"],[1,"channel-topic","mb-3"],[1,"channel-stats","d-flex","gap-4"],[1,"stat"],[1,"fas","fa-users","text-primary","me-1"],[1,"fas","fa-comment","text-success","me-1"],[1,"card-footer"],[1,"btn-group","btn-group-sm","w-100"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-eye","me-1"],[1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-edit","me-1"],[1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash","me-1"],[1,"fas","fa-lock"],[1,"fas","fa-eye-slash"],[1,"fas","fa-microphone-slash"],[1,"pagination"],[1,"page-item"],[1,"page-link",3,"click"],[1,"fas","fa-chevron-left"],[1,"page-item",3,"active"],[1,"fas","fa-chevron-right"],["tabindex","-1",1,"modal","show","d-block",3,"click"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-hashtag","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-6"],[1,"text-muted","mb-3"],[1,"row","mb-0"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"user-list"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"modal-backdrop","show"],[1,"badge","bg-secondary","me-1","mb-1"],[1,"modal-dialog","modal-dialog-centered"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","kanalnavn",1,"form-control",3,"ngModelChange","ngModel","disabled"],["type","text","placeholder","Kanalens tema...",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","mb-3"],[1,"col-6"],[1,"form-check"],["type","checkbox","id","isPrivate",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isPrivate",1,"form-check-label"],["type","checkbox","id","isSecret",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isSecret",1,"form-check-label"],["type","checkbox","id","isModerated",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isModerated",1,"form-check-label"],["type","checkbox","id","isInviteOnly",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isInviteOnly",1,"form-check-label"],["type","number","min","0","max","9999",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-save","me-2"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),o(4,"Kanaler"),i(),n(5,"p",2),o(6,"Administrer IRC-kanaler"),i()(),n(7,"div",3)(8,"button",4),p("click",function(){return t.refresh()}),_(9,"i",5),i(),n(10,"button",6),p("click",function(){return t.showCreateModal()}),_(11,"i",7),o(12,"Ny kanal "),i()()(),n(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"div",12)(18,"span",13),_(19,"i",14),i(),n(20,"input",15),f("ngModelChange",function(h){return g(t.searchQuery,h)||(t.searchQuery=h),h}),p("keyup.enter",function(){return t.search()}),i()()(),n(21,"div",16)(22,"select",17),f("ngModelChange",function(h){return g(t.filterType,h)||(t.filterType=h),h}),p("change",function(){return t.refresh()}),n(23,"option",18),o(24,"Alle typer"),i(),n(25,"option",19),o(26,"Offentlige"),i(),n(27,"option",20),o(28,"Private"),i(),n(29,"option",21),o(30,"Hemmelige"),i()()(),n(31,"div",22)(32,"button",23),p("click",function(){return t.search()}),_(33,"i",24),o(34,"S\xF8k "),i()()()()(),k(35,Z,4,0,"div",25)(36,$,5,0,"div",26)(37,le,4,1),i(),k(38,ce,42,9)(39,me,51,9)),r&2&&(s(8),V("disabled",t.loading()),s(),E("fa-spin",t.loading()),s(11),C("ngModel",t.searchQuery),s(2),C("ngModel",t.filterType),s(13),v(t.loading()?35:t.channels().length===0?36:37),s(3),v(t.selectedChannel()?38:-1),s(),v(t.showEditModal()?39:-1))},dependencies:[A,j,G,R,U,D,Q,K,H,z,q,Y,N],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:1rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;margin-bottom:.25rem}.channel-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease}.channel-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.channel-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:transparent;border-bottom-color:var(--bs-border-color)}.channel-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{background:transparent;border-top-color:var(--bs-border-color)}.channel-topic[_ngcontent-%COMP%]{color:var(--bs-gray-400);font-size:.9rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.channel-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{font-size:.85rem;color:var(--bs-gray-400)}.channel-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem}.modal[_ngcontent-%COMP%]{background:#00000080}.modal-content[_ngcontent-%COMP%]{background:var(--card-bg);border-color:var(--card-border)}.modal-header[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{border-color:var(--bs-border-color)}.user-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}"]})}return l})();export{ve as ChannelsComponent};
